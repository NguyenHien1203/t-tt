<p-dialog [(visible)]="show" [draggable]="true" [resizable]="false" (onHide)="Thoat()" (onShow)="BindDialogData()"
    [style]="{ width: '1350px' }" [modal]="true" header="Báo cáo tiến độ">
    <ng-template pTemplate="content">
        <div class="chiTiet">
            <div class="grid">
                <div class="col-12 md:col-12">
                    <p-table styleClass="p-datatable-gridlines" [value]="[baoCaoTienDos]" class="custom-table"
                        responsiveLayout="scroll">
                        <ng-template pTemplate="body" let-baoCaoTienDo>
                            <tr>
                                <td class="">
                                    <strong>Số kí hiệu văn bản:</strong>
                                </td>
                                <td class="">
                                    {{ baoCaoTienDo?.soKiHieu }}
                                </td>
                                <td class="">
                                    <strong>Trích yếu:</strong>
                                </td>
                                <td class="">
                                    {{ baoCaoTienDo?.trichYeu }}
                                </td>
                            </tr>
                            <tr>
                                <td class="">
                                    <strong>Nội dung công việc:</strong>
                                </td>
                                <td class="">
                                    {{ baoCaoTienDo?.noiDungCongViec }}
                                </td>
                                <td class="">
                                    <strong>Người xử lý/Phân cấp:</strong>
                                </td>
                                <td class="">
                                    {{ baoCaoTienDo?.nguoiXuLy }}
                                </td>
                            </tr>
                            <tr>
                                <td class="">
                                    <strong>Thời gian thực hiện dự kiến:</strong>
                                </td>
                                <td class="">
                                    <strong>Từ ngày: </strong>
                                    <span class="info">
                                        {{
                                        baoCaoTienDo?.tuNgay
                                        | date : "dd/MM/yyyy"
                                        }}</span>
                                </td>
                                <td class="" colspan="2">
                                    <strong>Đến ngày: </strong>
                                    {{
                                    baoCaoTienDo?.denNgay
                                    | date : "dd/MM/yyyy"
                                    }}
                                </td>
                            </tr>
                            <tr>
                                <td class="">
                                    <strong>
                                        Đề xuất thời hạn hoàn thành:</strong>
                                </td>
                                <td class="">
                                    <p-calendar [(ngModel)]="
                                            baoCaoTienDo.thoiHanHoanThanh
                                        " appendTo="body" dateFormat="dd/mm/yy" placeholder="Thời hạn hoàn thành"
                                        [style]="{ width: '100%' }" class="my-drop"></p-calendar>
                                </td>
                                <td class="" colspan="2">
                                    <button pbutton="" pripple="" type="submit" label="Info" icon="pi pi-check"
                                        class="p-element p-ripple p-button-warning p-button p-component"
                                        ng-reflect-label="Info" (click)="UpdateNgayHt()">
                                        <span class="p-button-label"><i class="pi pi-check"></i>&nbsp;Lưu
                                            lại</span><span class="p-ink"></span></button>&nbsp;
                                    <span class="info">
                                        Đã đề xuất thời hạn hoàn thành</span>
                                    :
                                    {{ baoCaoTienDo?.trangThaiDeXuat }}
                                </td>
                            </tr>
                            <tr>
                                <td class="">
                                    <strong> Người chỉ đạo:</strong>
                                </td>
                                <td class="">
                                    {{ baoCaoTienDo?.chiDao }}
                                </td>
                                <td class="">
                                    <strong> Người chỉ trì:</strong>
                                </td>
                                <td class="">
                                    {{ baoCaoTienDo?.chuTri }}
                                </td>
                            </tr>
                            <tr>
                                <td class="">
                                    <strong>
                                        Phối hợp thực hiện (
                                        <span class="info">{{ baoCaoTienDo?.countDongChiPhoiHop }}</span>
                                        đ/c)</strong>
                                </td>
                                <td class="">
                                    <p-table [paginator]="false" [value]="
                                            baoCaoTienDo?.lstDongChiPhoiHop
                                        " dataKey="id" [rowHover]="true" styleClass="p-datatable-gridlines"
                                        responsiveLayout="scroll">
                                        <ng-template pTemplate="body" let-phoiHop let-rowIndex="rowIndex">
                            <tr>
                                <td class="">
                                    {{ phoiHop.text }}
                                </td>
                                <td>
                                    <span class="info">
                                        {{
                                        phoiHop.trangThai
                                        }}</span>
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="emptymessage">
                            <tr>
                                <td colspan="15">0 đ/c</td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="loadingbody">
                            <tr>
                                <td colspan="15">
                                    Loading record data. Please
                                    wait.
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>
                    </td>
                    <td class="">
                        <strong>
                            Thông báo để biết (
                            <span class="info">{{ baoCaoTienDo?.countDongChiThongBao }}</span>
                            đ/c)
                        </strong>
                    </td>
                    <td class="">
                        <p-table [paginator]="false" [value]="
                                            baoCaoTienDo?.lstDongChiThongBao
                                        " dataKey="id" [rowHover]="true" styleClass="p-datatable-gridlines"
                            responsiveLayout="scroll">
                            <ng-template pTemplate="body" let-thongBao let-rowIndex="rowIndex">
                                <tr>
                                    <td class="">
                                        {{ thongBao.text }}
                                    </td>
                                    <td>
                                        <span class="info">
                                            {{
                                            thongBao.trangThai
                                            }}</span>
                                    </td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td colspan="15">0 đ/c</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="loadingbody">
                                <tr>
                                    <td colspan="15">
                                        Loading record data. Please
                                        wait.
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </td>
                    </tr>
                    <tr>
                        <td class="" colspan="4">
                            <strong>
                                NHẬP CÁC THÔNG TIN XỬ LÝ CỦA CÁ NHÂN
                            </strong>
                        </td>
                    </tr>
                    <tr>
                        <td class="">
                            <strong> Ngày xử lý: </strong>
                        </td>
                        <td class="">
                            <p-calendar [(ngModel)]="baoCaoTienDo.ngayXuLy" appendTo="body" dateFormat="dd/mm/yy"
                                placeholder="Thời hoạn hoàn thành" [style]="{ width: '100%' }"
                                class="my-drop"></p-calendar>
                        </td>
                        <td class="" rowspan="2">Nội dung xử lý:</td>
                        <td class="" rowspan="2">
                            <textarea rows="4" cols="30" class="my-drop" [(ngModel)]="baoCaoTienDo.noiDungXuLy"
                                placeholder="Nội dung" pInputTextarea></textarea>
                        </td>
                    </tr>
                    <tr>
                        <td class="">
                            <strong> Chọn trạng thái: </strong>
                        </td>
                        <td class="custom-r">
                            <p-dropdown [options]="lstTrangThai" optionValue="value"
                                [(ngModel)]="baoCaoTienDo.trangThaiXuLy" optionLabel="text" [showClear]="true"
                                [filter]="false" appendTo="body" placeholder="Chọn trạng thái"
                                [style]="{ width: '100%' }" class="my-drop"></p-dropdown>
                        </td>
                    </tr>
                    <tr>
                        <td class="">
                            <strong>Đính kèm file:</strong>
                        </td>
                        <td class="">
                            <div>
                                <label for="fileUpload" class="custom-file-upload">
                                    <i class="pi pi-upload"></i> Chọn
                                    tệp
                                </label>
                                <input type="file" id="fileUpload" multiple="multiple" (change)="onFileSelected($event)"
                                    style="display: none" />
                            </div>
                            <ul>
                                <li *ngFor="let file of selectedFiles"><a (click)="downloadFile(file)" href="javascript:;">{{file.name}}</a><a href="javascript:;" (click)="XoaFile(file.name)">&nbsp;<i class="pi pi-trash"></i></a></li>
                            </ul>
                        </td>
                        <td class="">
                            <strong>Chọn văn bản trong hệ thống:</strong>
                        </td>
                        <td class="fl-wr">
                            <button pbutton="" pripple="" type="submit" label="Info" icon="pi pi-check"
                                class="p-element p-ripple p-button-warning p-button p-component" ng-reflect-label="Info"
                                (click)="ChonVanBan()">
                                <span class="p-button-label"><i class="pi pi-check"></i>&nbsp;Chọn văn bản</span><span
                                    class="p-ink"></span>
                            </button>
                            <p-table [paginator]="false" [value]="lstChonVanBan" dataKey="id" [rowHover]="true"
                                class="my-drop" styleClass="p-datatable-gridlines" responsiveLayout="scroll">
                                <ng-template pTemplate="header">
                    <tr>
                        <th style="width: 2%">
                            <div class="flex justify-content-between align-baoCaoTienDo?s-center">
                                STT
                            </div>
                        </th>
                        <th style="min-width: 10rem">
                            <div class="flex justify-content-between align-baoCaoTienDo?s-center">
                                Số ký hiệu
                            </div>
                        </th>
                        <th style="min-width: 10rem">
                            <div class="flex justify-content-between align-baoCaoTienDo?s-center">
                                Trích yếu
                            </div>
                        </th>
                        <th style="min-width: 10rem">
                            <div class="flex justify-content-between align-baoCaoTienDo?s-center">
                                Xóa
                            </div>
                        </th>
                    </tr>
    </ng-template>
    <ng-template pTemplate="body" let-vanBan let-rowIndex="rowIndex">
        <tr>
            <td style="text-align: center">
                {{ rowIndex + 1 }}
            </td>
            <td>
                {{ vanBan.soKiHieu }}
            </td>
            <td>
                {{ vanBan.trichYeu }}
            </td>
            <td>Xóa</td>
        </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
        <tr>
            <td colspan="15">
                No record found.
            </td>
        </tr>
    </ng-template>
    <ng-template pTemplate="loadingbody">
        <tr>
            <td colspan="15">
                Loading record data. Please
                wait.
            </td>
        </tr>
    </ng-template>
    </p-table>
    </td>
    </tr>
    </ng-template>
    </p-table>
    </div>
    </div>
    </div>
    </ng-template>
    <app-chon-van-ban [show]="hienThiChonVanBan" (tatPopup)="ThoatChonVanBan($event, 'C')"></app-chon-van-ban>
    <ng-template pTemplate="footer">
        <div class="div-center">
            <button pbutton="" pripple="" type="submit" label="Info"
                class="p-element p-ripple p-button-info p-button p-component" ng-reflect-label="Info"
                (click)="CapNhatTienDo()">
                <span class="p-button-label">Lưu</span><span class="p-ink"></span></button>&nbsp;
            <button pbutton="" pripple="" label="Info" class="p-element p-ripple p-button-danger p-button p-component"
                ng-reflect-label="Info" (click)="Thoat()">
                <span class="p-button-label">Thoát</span><span class="p-ink"></span>
            </button>
        </div>
    </ng-template>
</p-dialog>